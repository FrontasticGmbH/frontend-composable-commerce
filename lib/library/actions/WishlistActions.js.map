{"version":3,"sources":["../../../src/library/actions/WishlistActions.ts"],"sourcesContent":["import { Event, SDK, ServerOptions } from \"@commercetools/frontend-sdk\";\nimport {\n\tAddToWishlistPayload,\n\tRemoveFromWishlistPayload,\n\tUpdateWishlistItemPayload,\n} from \"../../types/payloads/WishlistPayloads\";\nimport {\n\tAddToWishlistAction,\n\tGetWishlistAction,\n\tRemoveFromWishlistAction,\n\tUpdateWishlistItemAction,\n} from \"../../types/actions/WishlistActions\";\nimport { Wishlist } from \"shared/types/wishlist\";\nimport { ComposableCommerceEvents } from \"../../types/events/ComposableCommerceEvents\";\n\nexport type WishlistActions = {\n\tgetWishlist: GetWishlistAction;\n\taddItem: AddToWishlistAction;\n\tremoveItem: RemoveFromWishlistAction;\n\tupdateItem: UpdateWishlistItemAction;\n};\n\nexport const getWishlistActions = (\n\tsdk: SDK<ComposableCommerceEvents>\n): WishlistActions => {\n\treturn {\n\t\tgetWishlist: async (\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Wishlist>({\n\t\t\t\tactionName: \"wishlist/getWishlist\",\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"wishlistFetched\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\twishlist: response.data,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\taddItem: async (\n\t\t\tpayload: AddToWishlistPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Wishlist>({\n\t\t\t\tactionName: \"wishlist/addToWishlist\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tconst lineItem = response.data.lineItems?.find(\n\t\t\t\t\t(lineItem) => lineItem.variant?.sku === payload.variant.sku\n\t\t\t\t);\n\t\t\t\tif (lineItem) {\n\t\t\t\t\tsdk.trigger(\n\t\t\t\t\t\tnew Event({\n\t\t\t\t\t\t\teventName: \"lineItemAddedToWishlist\",\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tlineItem,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tremoveItem: async (\n\t\t\tpayload: RemoveFromWishlistPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Wishlist>({\n\t\t\t\tactionName: \"wishlist/removeLineItem\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (\n\t\t\t\tresponse.isError === false &&\n\t\t\t\t!response.data.lineItems?.find(\n\t\t\t\t\t(item) => item.lineItemId === payload.lineItem.id\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"lineItemRemovedFromWishlist\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tlineItemId: payload.lineItem.id,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tupdateItem: async (\n\t\t\tpayload: UpdateWishlistItemPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Wishlist>({\n\t\t\t\tactionName: \"wishlist/updateLineItemCount\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tconst lineItem = response.data.lineItems?.find(\n\t\t\t\t\t(item) => item.lineItemId === payload.lineItem.id\n\t\t\t\t);\n\t\t\t\tif (lineItem?.count === payload.count) {\n\t\t\t\t\tsdk.trigger(\n\t\t\t\t\t\tnew Event({\n\t\t\t\t\t\t\teventName: \"wishlistLineItemUpdated\",\n\t\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\t\tlineItem: lineItem,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t};\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAA0C;AAsBnC,IAAM,qBAAqB,CACjC,QACqB;AACrB,SAAO;AAAA,IACN,aAAa,OACZ,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAqB;AAAA,QAC/C,YAAY;AAAA,QACZ,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,UAAU,SAAS;AAAA,YACpB;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,SAAS,OACR,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAqB;AAAA,QAC/C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,cAAM,WAAW,SAAS,KAAK,WAAW;AAAA,UACzC,CAACA,cAAaA,UAAS,SAAS,QAAQ,QAAQ,QAAQ;AAAA,QACzD;AACA,YAAI,UAAU;AACb,cAAI;AAAA,YACH,IAAI,0BAAM;AAAA,cACT,WAAW;AAAA,cACX,MAAM;AAAA,gBACL;AAAA,cACD;AAAA,YACD,CAAC;AAAA,UACF;AAAA,QACD;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,YAAY,OACX,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAqB;AAAA,QAC/C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UACC,SAAS,YAAY,SACrB,CAAC,SAAS,KAAK,WAAW;AAAA,QACzB,CAAC,SAAS,KAAK,eAAe,QAAQ,SAAS;AAAA,MAChD,GACC;AACD,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,YAAY,QAAQ,SAAS;AAAA,YAC9B;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,YAAY,OACX,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAqB;AAAA,QAC/C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,cAAM,WAAW,SAAS,KAAK,WAAW;AAAA,UACzC,CAAC,SAAS,KAAK,eAAe,QAAQ,SAAS;AAAA,QAChD;AACA,YAAI,UAAU,UAAU,QAAQ,OAAO;AACtC,cAAI;AAAA,YACH,IAAI,0BAAM;AAAA,cACT,WAAW;AAAA,cACX,MAAM;AAAA,gBACL;AAAA,cACD;AAAA,YACD,CAAC;AAAA,UACF;AAAA,QACD;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,EACD;AACD;","names":["lineItem"]}