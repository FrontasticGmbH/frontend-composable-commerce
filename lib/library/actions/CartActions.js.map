{"version":3,"sources":["../../../src/library/actions/CartActions.ts"],"sourcesContent":["import { Event, SDK, ServerOptions } from \"@commercetools/frontend-sdk\";\nimport {\n\tAddCartItemPayload,\n\tGetCartShippingMethodsPayload,\n\tRedeemDiscountCodePayload,\n\tRemoveCartItemPayload,\n\tRemoveDiscountCodePayload,\n\tSetCartShippingMethodPayload,\n\tUpdateCartItemPayload,\n\tUpdateCartPayload,\n} from \"../../types/payloads/CartPayloads\";\nimport {\n\tAddCartItemAction,\n\tCheckoutCartAction,\n\tGetAvailableCartShippingMethodsAction,\n\tGetCartAction,\n\tGetCartShippingMethodsAction,\n\tQueryOrdersAction,\n\tRedeemDiscountCodeAction,\n\tRemoveCartItemAction,\n\tRemoveDiscountCodeAction,\n\tSetCartShippingMethodAction,\n\tUpdateCartAction,\n\tUpdateCartItemAction,\n} from \"../../types/actions/CartActions\";\nimport { Cart, ShippingMethod, Order } from \"shared/types/cart\";\nimport { ComposableCommerceEvents } from \"../../types/events/ComposableCommerceEvents\";\nimport { QueryOrdersQuery } from \"../../types/queries/CartQueries\";\nimport { PaginatedResult } from \"shared/types/result\";\n\nexport type CartActions = {\n\tgetCart: GetCartAction;\n\taddItem: AddCartItemAction;\n\tremoveItem: RemoveCartItemAction;\n\tupdateItem: UpdateCartItemAction;\n\tupdateCart: UpdateCartAction;\n\tgetShippingMethods: GetCartShippingMethodsAction;\n\tgetAvailableShippingMethods: GetAvailableCartShippingMethodsAction;\n\tsetShippingMethod: SetCartShippingMethodAction;\n\tredeemDiscountCode: RedeemDiscountCodeAction;\n\tremoveDiscountCode: RemoveDiscountCodeAction;\n\tcheckout: CheckoutCartAction;\n\tqueryOrders: QueryOrdersAction;\n};\n\nexport const getCartActions = (\n\tsdk: SDK<ComposableCommerceEvents>\n): CartActions => {\n\treturn {\n\t\tgetCart: async (options: { serverOptions?: ServerOptions } = {}) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/getCart\",\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"cartFetched\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tcart: response,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\taddItem: async (\n\t\t\tpayload: AddCartItemPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/addToCart\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"productAddedToCart\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tproduct: payload.variant,\n\t\t\t\t\t\t\tquantity: payload.variant.count,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tremoveItem: async (\n\t\t\tpayload: RemoveCartItemPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/removeLineItem\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"productRemovedFromCart\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tproduct: payload.lineItem,\n\t\t\t\t\t\t\tquantity: 1,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tupdateItem: async (\n\t\t\tpayload: UpdateCartItemPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/updateLineItem\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"productUpdatedInCart\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tproduct: {\n\t\t\t\t\t\t\t\tid: payload.lineItem.id,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tnewQuantity: payload.lineItem.count,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tupdateCart: async (\n\t\t\tpayload: UpdateCartPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/updateCart\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"cartUpdated\",\n\t\t\t\t\t\tdata: payload,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tgetShippingMethods: async (\n\t\t\tpayload?: GetCartShippingMethodsPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<ShippingMethod[]>({\n\t\t\t\tactionName: \"cart/getShippingMethods\",\n\t\t\t\tquery: payload?.query ?? undefined,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"shippingMethodsFetched\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tshippingMethods: response.data,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tgetAvailableShippingMethods: async (\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<ShippingMethod[]>({\n\t\t\t\tactionName: \"cart/getAvailableShippingMethods\",\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"availableShippingMethodsFetched\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tshippingMethods: response.data,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tsetShippingMethod: async (\n\t\t\tpayload: SetCartShippingMethodPayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/setShippingMethod\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"shippingMethodUpdated\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tshippingMethod:\n\t\t\t\t\t\t\t\tresponse.data.availableShippingMethods?.find(\n\t\t\t\t\t\t\t\t\t(shippingMethod) =>\n\t\t\t\t\t\t\t\t\t\tshippingMethod.shippingMethodId ===\n\t\t\t\t\t\t\t\t\t\tpayload.shippingMethod.id\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tredeemDiscountCode: async (\n\t\t\tpayload: RedeemDiscountCodePayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Cart | string>({\n\t\t\t\tactionName: \"cart/redeemDiscount\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"discountCodeRedeemed\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tdiscountCode:\n\t\t\t\t\t\t\t\ttypeof response.data !== \"string\"\n\t\t\t\t\t\t\t\t\t? payload.code\n\t\t\t\t\t\t\t\t\t: response.data,\n\t\t\t\t\t\t\tcart:\n\t\t\t\t\t\t\t\ttypeof response.data !== \"string\"\n\t\t\t\t\t\t\t\t\t? response.data\n\t\t\t\t\t\t\t\t\t: undefined,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tremoveDiscountCode: async (\n\t\t\tpayload: RemoveDiscountCodePayload,\n\t\t\toptions: { serverOptions?: ServerOptions } = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/removeDiscount\",\n\t\t\t\tpayload,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"discountCodeRemoved\",\n\t\t\t\t\t\tdata: {\n\t\t\t\t\t\t\tdiscountCode: payload.discountId,\n\t\t\t\t\t\t\tcart: response.data,\n\t\t\t\t\t\t},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tcheckout: async (options: { serverOptions?: ServerOptions } = {}) => {\n\t\t\tconst response = await sdk.callAction<Cart>({\n\t\t\t\tactionName: \"cart/checkout\",\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\n\t\t\tif (response.isError === false) {\n\t\t\t\tsdk.trigger(\n\t\t\t\t\tnew Event({\n\t\t\t\t\t\teventName: \"cartCheckedOut\",\n\t\t\t\t\t\tdata: {},\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn response;\n\t\t},\n\t\tqueryOrders: async (\n\t\t\tquery?: QueryOrdersQuery,\n\t\t\toptions: {\n\t\t\t\tserverOptions?: ServerOptions;\n\t\t\t} = {}\n\t\t) => {\n\t\t\tconst response = await sdk.callAction<PaginatedResult<Order>>({\n\t\t\t\tactionName: \"cart/queryOrders\",\n\t\t\t\tquery,\n\t\t\t\tserverOptions: options.serverOptions,\n\t\t\t});\n\t\t\treturn response;\n\t\t},\n\t};\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,0BAA0C;AA6CnC,IAAM,iBAAiB,CAC7B,QACiB;AACjB,SAAO;AAAA,IACN,SAAS,OAAO,UAA6C,CAAC,MAAM;AACnE,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,MAAM;AAAA,YACP;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,SAAS,OACR,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,SAAS,QAAQ;AAAA,cACjB,UAAU,QAAQ,QAAQ;AAAA,YAC3B;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,YAAY,OACX,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,SAAS,QAAQ;AAAA,cACjB,UAAU;AAAA,YACX;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,YAAY,OACX,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,SAAS;AAAA,gBACR,IAAI,QAAQ,SAAS;AAAA,cACtB;AAAA,cACA,aAAa,QAAQ,SAAS;AAAA,YAC/B;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,YAAY,OACX,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,UACP,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,oBAAoB,OACnB,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAA6B;AAAA,QACvD,YAAY;AAAA,QACZ,OAAO,SAAS,SAAS;AAAA,QACzB,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,iBAAiB,SAAS;AAAA,YAC3B;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,6BAA6B,OAC5B,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAA6B;AAAA,QACvD,YAAY;AAAA,QACZ,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,iBAAiB,SAAS;AAAA,YAC3B;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,mBAAmB,OAClB,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,gBACC,SAAS,KAAK,0BAA0B;AAAA,gBACvC,CAAC,mBACA,eAAe,qBACf,QAAQ,eAAe;AAAA,cACzB;AAAA,YACF;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,oBAAoB,OACnB,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAA0B;AAAA,QACpD,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,cACC,OAAO,SAAS,SAAS,WACtB,QAAQ,OACR,SAAS;AAAA,cACb,MACC,OAAO,SAAS,SAAS,WACtB,SAAS,OACT;AAAA,YACL;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,oBAAoB,OACnB,SACA,UAA6C,CAAC,MAC1C;AACJ,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM;AAAA,cACL,cAAc,QAAQ;AAAA,cACtB,MAAM,SAAS;AAAA,YAChB;AAAA,UACD,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,UAAU,OAAO,UAA6C,CAAC,MAAM;AACpE,YAAM,WAAW,MAAM,IAAI,WAAiB;AAAA,QAC3C,YAAY;AAAA,QACZ,eAAe,QAAQ;AAAA,MACxB,CAAC;AAED,UAAI,SAAS,YAAY,OAAO;AAC/B,YAAI;AAAA,UACH,IAAI,0BAAM;AAAA,YACT,WAAW;AAAA,YACX,MAAM,CAAC;AAAA,UACR,CAAC;AAAA,QACF;AAAA,MACD;AACA,aAAO;AAAA,IACR;AAAA,IACA,aAAa,OACZ,OACA,UAEI,CAAC,MACD;AACJ,YAAM,WAAW,MAAM,IAAI,WAAmC;AAAA,QAC7D,YAAY;AAAA,QACZ;AAAA,QACA,eAAe,QAAQ;AAAA,MACxB,CAAC;AACD,aAAO;AAAA,IACR;AAAA,EACD;AACD;","names":[]}